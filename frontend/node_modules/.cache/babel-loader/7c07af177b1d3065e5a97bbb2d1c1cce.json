{"ast":null,"code":"var _jsxFileName = \"/Users/dougschallmoser/Development/learning/react/14-photography-store/frontend/src/components/Stripe/CheckoutForm.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext } from 'react';\nimport { CartContext } from '../../contexts/CartContext';\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport * as EmailValidator from 'email-validator';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CARD_OPTIONS = {\n  style: {\n    base: {\n      iconColor: 'rgb(110, 223, 170)',\n      color: '#000',\n      fontSize: '16px',\n      fontSmoothing: 'antialiased',\n      ':-webkit-autofill': {\n        color: 'rgb(110, 223, 170)'\n      },\n      '::placeholder': {\n        color: 'rgb(110, 223, 170)'\n      }\n    },\n    invalid: {\n      iconColor: 'rgb(226, 110, 110)',\n      color: 'rgb(226, 110, 110)'\n    }\n  }\n};\n\nfunction CheckoutForm() {\n  _s();\n\n  const stripe = useStripe();\n  const elements = useElements();\n  const {\n    shipping,\n    cartCost,\n    updateCheckout,\n    clearCart\n  } = useContext(CartContext);\n  const [success, setSuccess] = useState(false);\n  const [userInfo, setUserInfo] = useState({\n    name: '',\n    email: '',\n    address: '',\n    city: '',\n    state: '',\n    zip: ''\n  });\n\n  const handleChange = event => {\n    setUserInfo({ ...userInfo,\n      [event.target.name]: event.target.value\n    });\n  };\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    const {\n      error,\n      paymentMethod\n    } = await stripe.createPaymentMethod({\n      type: \"card\",\n      card: elements.getElement(CardElement)\n    });\n\n    if (!error) {\n      try {\n        const response = await axios.post('http://localhost:8080/stripe/charge', {\n          amount: cartCost * 100,\n          id: paymentMethod.id\n        });\n\n        if (response.data.success) {\n          setSuccess(true);\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    } else {\n      console.log(error.message);\n    }\n  };\n\n  const validate = (name, email, address, city, state, zip) => {\n    return {\n      name: name.length < 2,\n      email: !EmailValidator.validate(email),\n      address: address.length < 5,\n      city: city.length < 2,\n      state: state.length > 2 || state.length === 1,\n      zip: zip.length > 5 || zip.length < 5\n    };\n  };\n\n  const {\n    name,\n    email,\n    address,\n    city,\n    state,\n    zip\n  } = userInfo;\n  const errors = validate(name, email, address, city, state, zip);\n  const disabled = Object.keys(errors).some(name => errors[name]);\n  return success ? /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Success\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"close-btn\",\n      type: \"button\",\n      onClick: () => clearCart(),\n      children: \"Close\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"checkout-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"checkout-header\",\n        children: \"Checkout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"name\",\n          children: \"Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"name\",\n          name: \"name\",\n          value: name,\n          onChange: handleChange,\n          className: name.length > 0 ? errors.name ? \"error\" : \"success\" : \"\",\n          placeholder: \"Doug Programmer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"email\",\n          name: \"email\",\n          value: email,\n          onChange: handleChange,\n          className: email.length > 0 ? errors.email ? \"error\" : \"success\" : \"\",\n          placeholder: \"doug@example.com\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"address\",\n          children: \"Address\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"address\",\n          name: \"address\",\n          value: address,\n          onChange: handleChange,\n          className: address.length > 0 ? errors.address ? \"error\" : \"success\" : \"\",\n          placeholder: \"185 Berry Street Suite 400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"city\",\n          children: \"City\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"city\",\n          name: \"city\",\n          value: city,\n          onChange: handleChange,\n          className: city.length > 0 ? errors.city ? \"error\" : \"success\" : \"\",\n          placeholder: \"Bellingham\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"state\",\n          children: \"State\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"state\",\n          name: \"state\",\n          value: state.toUpperCase(),\n          maxLength: 2,\n          onChange: handleChange,\n          className: state.length > 0 ? errors.state ? \"error\" : \"success\" : \"\",\n          placeholder: \"WA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"zip\",\n          children: \"Zip\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"zip\",\n          name: \"zip\",\n          value: zip,\n          maxLength: 5,\n          onChange: handleChange,\n          className: zip.length > 0 ? errors.zip ? \"error\" : \"success\" : \"\",\n          placeholder: \"98226\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"note\",\n        children: \"Secure checkout provided through Stripe\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 7\n      }, this), \"Total Cost: $\", (cartCost + shipping).toFixed(2), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"FormRow\",\n        children: /*#__PURE__*/_jsxDEV(CardElement, {\n          options: CARD_OPTIONS\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: disabled,\n        className: \"pay-btn\",\n        children: \"Pay\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close-btn\",\n        type: \"button\",\n        onClick: () => updateCheckout(false),\n        children: \"Cancel\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n}\n\n_s(CheckoutForm, \"evQM0OQYaCeR1MRXegXitG3lMgQ=\", false, function () {\n  return [useStripe, useElements];\n});\n\n_c = CheckoutForm;\nexport default CheckoutForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckoutForm\");","map":{"version":3,"sources":["/Users/dougschallmoser/Development/learning/react/14-photography-store/frontend/src/components/Stripe/CheckoutForm.tsx"],"names":["React","useState","useContext","CartContext","CardElement","useStripe","useElements","EmailValidator","axios","CARD_OPTIONS","style","base","iconColor","color","fontSize","fontSmoothing","invalid","CheckoutForm","stripe","elements","shipping","cartCost","updateCheckout","clearCart","success","setSuccess","userInfo","setUserInfo","name","email","address","city","state","zip","handleChange","event","target","value","handleSubmit","preventDefault","error","paymentMethod","createPaymentMethod","type","card","getElement","response","post","amount","id","data","err","console","log","message","validate","length","errors","disabled","Object","keys","some","toUpperCase","toFixed"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport { CartContext } from '../../contexts/CartContext';\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport * as EmailValidator from 'email-validator';\nimport axios from 'axios';\n\nconst CARD_OPTIONS = {\n  style: {\n    base: {\n      iconColor: 'rgb(110, 223, 170)',\n      color: '#000',\n      fontSize: '16px',\n      fontSmoothing: 'antialiased',\n      ':-webkit-autofill': {color: 'rgb(110, 223, 170)'},\n      '::placeholder': {color: 'rgb(110, 223, 170)'},\n    },\n    invalid: {\n      iconColor: 'rgb(226, 110, 110)',\n      color: 'rgb(226, 110, 110)',\n    },\n  },\n};\n\nfunction CheckoutForm() {\n\n  const stripe = useStripe();\n  const elements = useElements();\n  const { shipping, cartCost, updateCheckout, clearCart } = useContext(CartContext);\n  const [success, setSuccess] = useState(false);\n\n  const [userInfo, setUserInfo] = useState({\n    name: '',\n    email: '',\n    address: '',\n    city: '',\n    state: '',\n    zip: ''\n  })\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setUserInfo({\n      ...userInfo,\n      [event.target.name]: event.target.value\n    })\n  }\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const { error, paymentMethod } = await stripe!.createPaymentMethod({\n      type: \"card\",\n      card: elements!.getElement(CardElement)!\n    })\n\n    if (!error) {\n      try {\n        const response = await axios.post(\n          'http://localhost:8080/stripe/charge',\n          {\n            amount: cartCost * 100,\n            id: paymentMethod!.id\n          }\n        )\n        \n        if (response.data.success) {\n          setSuccess(true)\n        }\n      } catch (err) {\n        console.log(err)\n      }\n    } else {\n      console.log(error.message)\n    }\n  }\n\n  const validate = (name: string, email: string, address: string, city: string, state: string, zip: string) => {\n    return {\n      name: name.length < 2,\n      email: !EmailValidator.validate(email),\n      address: address.length < 5,\n      city: city.length < 2,\n      state: state.length > 2 || state.length === 1,\n      zip: zip.length > 5 || zip.length < 5\n    }\n  }\n\n  const { name, email, address, city, state, zip } = userInfo;\n  const errors: { [key: string]: boolean } = validate(name, email, address, city, state, zip);\n  const disabled = Object.keys(errors).some(name => errors[name])\n\n  return (\n    success ?\n      <>\n        <div>Success</div>\n        <button className=\"close-btn\" type=\"button\" onClick={() => clearCart()}>Close</button>\n      </>\n      :\n      <>\n    <form id=\"checkout-form\" onSubmit={handleSubmit}>\n      <div id=\"checkout-header\">Checkout</div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"name\">Name</label>\n        <input\n          type=\"text\"\n          id=\"name\"\n          name=\"name\"\n          value={name}\n          onChange={handleChange}\n          className={name.length > 0 ? (errors.name ? \"error\" : \"success\") : \"\"}\n          placeholder=\"Doug Programmer\"\n        />\n      </div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"email\">Email</label>\n        <input\n          type=\"text\"\n          id=\"email\"\n          name=\"email\"\n          value={email}\n          onChange={handleChange}\n          className={email.length > 0 ? (errors.email ? \"error\" : \"success\") : \"\"}\n          placeholder=\"doug@example.com\"\n        />\n      </div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"address\">Address</label>\n        <input\n          type=\"text\"\n          id=\"address\"\n          name=\"address\"\n          value={address}\n          onChange={handleChange}\n          className={address.length > 0 ? (errors.address ? \"error\" : \"success\") : \"\"}\n          placeholder=\"185 Berry Street Suite 400\"\n        />\n      </div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"city\">City</label>\n        <input\n          type=\"text\"\n          id=\"city\"\n          name=\"city\"\n          value={city}\n          onChange={handleChange}\n          className={city.length > 0 ? (errors.city ? \"error\" : \"success\") : \"\"}\n          placeholder=\"Bellingham\"\n        />\n      </div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"state\">State</label>\n        <input\n          type=\"text\"\n          id=\"state\"\n          name=\"state\"\n          value={state.toUpperCase()}\n          maxLength={2}\n          onChange={handleChange}\n          className={state.length > 0 ? (errors.state ? \"error\" : \"success\") : \"\"}\n          placeholder=\"WA\"\n        />\n      </div>\n      <div className=\"FormRow\">\n        <label htmlFor=\"zip\">Zip</label>\n        <input\n          type=\"text\"\n          id=\"zip\"\n          name=\"zip\"\n          value={zip}\n          maxLength={5}\n          onChange={handleChange}\n          className={zip.length > 0 ? (errors.zip ? \"error\" : \"success\") : \"\"}\n          placeholder=\"98226\"\n        />\n      </div>\n      <hr/>\n      <div className=\"note\">Secure checkout provided through Stripe</div>\n      Total Cost: ${(cartCost + shipping).toFixed(2)}\n      <div className=\"FormRow\">\n        <CardElement options={CARD_OPTIONS} />\n      </div>\n      <button disabled={disabled} className=\"pay-btn\">Pay</button>\n      <button className=\"close-btn\" type=\"button\" onClick={() => updateCheckout(false)}>Cancel</button>\n    </form>\n    </>\n  )\n}\n\nexport default CheckoutForm"]},"metadata":{},"sourceType":"module"}