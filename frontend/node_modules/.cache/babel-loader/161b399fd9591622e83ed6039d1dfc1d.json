{"ast":null,"code":"const Storage = cartItems => {\n  localStorage.setItem('cart', JSON.stringify(cartItems.length > 0 ? cartItems : []));\n};\n\n_c = Storage;\nexport function tallyCart(items) {\n  Storage(items);\n  const cartCount = items.reduce((tot, item) => tot + item.quantity, 0);\n  const cartCost = items.reduce((tot, item) => tot + item.price * item.quantity, 0);\n  return {\n    cartCount,\n    cartCost\n  };\n}\n\nfunction CartReducer(state, action) {\n  switch (action.type) {\n    case 'ADD_ITEM':\n      const item = state.cartItems.find(item => item.id === action.payload.id && item.size === action.payload.size);\n\n      if (!item) {\n        state.cartItems.push({ ...action.payload,\n          quantity: 1\n        });\n      } else {\n        item.quantity++;\n      }\n\n      return { ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      };\n\n    case 'REMOVE_ITEM':\n      const removedItem = state.cartItems.find(item => item.id === action.payload.id && item.size === action.payload.size);\n      state.cartItems.splice(state.cartItems.indexOf(removedItem), 1);\n      return { ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      };\n\n    case 'INCREASE_QTY':\n      state.cartItems.find(item => item.id === action.payload.id).quantity++;\n      return { ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      };\n\n    case 'DECREASE_QTY':\n      state.cartItems.find(item => item.id === action.payload.id).quantity--;\n      return { ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      };\n\n    case 'CLEAR_CART':\n      return { ...state,\n        ...tallyCart([]),\n        cartItems: []\n      };\n\n    case 'CHECKOUT':\n      return { ...state,\n        checkout: action.payload\n      };\n\n    default:\n      return state;\n  }\n}\n\n_c2 = CartReducer;\nexport default CartReducer;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Storage\");\n$RefreshReg$(_c2, \"CartReducer\");","map":{"version":3,"sources":["/Users/dougschallmoser/Development/learning/react/14-photography-store/src/contexts/CartReducer.tsx"],"names":["Storage","cartItems","localStorage","setItem","JSON","stringify","length","tallyCart","items","cartCount","reduce","tot","item","quantity","cartCost","price","CartReducer","state","action","type","find","id","payload","size","push","removedItem","splice","indexOf","checkout"],"mappings":"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","sourcesContent":["import { ApplicationState, StateAction, Item } from '../types';\n\nconst Storage = (cartItems: Item[]) => {\n  localStorage.setItem('cart', JSON.stringify(cartItems.length > 0 ? cartItems: []));\n}\n\nexport function tallyCart(items: Item[]) {\n  Storage(items)\n  const cartCount = items.reduce((tot, item) => tot + item.quantity, 0)\n  const cartCost = items.reduce((tot, item) => tot + item.price * item.quantity, 0)\n  return {\n    cartCount,\n    cartCost\n  }\n}\n\nfunction CartReducer(state: ApplicationState, action: StateAction): ApplicationState {\n  switch (action.type) {\n    case 'ADD_ITEM':\n      const item = state.cartItems.find(item => item.id === action.payload.id && item.size === action.payload.size)\n\n      if (!item) {\n        state.cartItems.push({...action.payload, quantity: 1})\n      } else {\n        item.quantity++\n      }\n\n      return {\n        ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      }\n    case 'REMOVE_ITEM':\n      const removedItem = state.cartItems.find(item => item.id === action.payload.id && item.size === action.payload.size)\n      state.cartItems.splice(state.cartItems.indexOf(removedItem!), 1)\n      \n      return {\n        ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      }\n    case 'INCREASE_QTY':\n      state.cartItems.find(item => item.id === action.payload.id)!.quantity++\n\n      return {\n        ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      }\n    case 'DECREASE_QTY':\n      state.cartItems.find(item => item.id === action.payload.id)!.quantity--\n\n      return {\n        ...state,\n        ...tallyCart(state.cartItems),\n        cartItems: [...state.cartItems]\n      }\n    case 'CLEAR_CART':\n      return {\n        ...state,\n        ...tallyCart([]),\n        cartItems: []\n      }\n    case 'CHECKOUT':\n      return {\n        ...state,\n        checkout: action.payload\n      }\n    default: \n      return state\n  }\n}\n\nexport default CartReducer"]},"metadata":{},"sourceType":"module"}